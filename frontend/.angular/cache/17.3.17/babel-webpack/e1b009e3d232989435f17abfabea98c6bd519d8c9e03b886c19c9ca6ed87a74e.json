{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor() {\n      this.router = inject(Router);\n      this.inactivityTimer = null;\n      this.autoLogoutMs = 60_000; // 1 minuto\n      // Reinicia temporizador ante interacción del usuario\n      ['click', 'keydown', 'mousemove', 'touchstart', 'scroll'].forEach(ev => window.addEventListener(ev, () => this.bumpActivity(), {\n        passive: true\n      }));\n      // Programa auto-logout si ya hay sesión al cargar\n      if (this.isLoggedIn()) this.scheduleAutoLogout();\n    }\n    isLoggedIn() {\n      return !!localStorage.getItem('token');\n    }\n    currentUser() {\n      try {\n        return JSON.parse(localStorage.getItem('user') || 'null');\n      } catch {\n        return null;\n      }\n    }\n    setSession(token, user) {\n      localStorage.setItem('token', token);\n      localStorage.setItem('user', JSON.stringify(user));\n      this.scheduleAutoLogout();\n    }\n    logout() {\n      try {\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n      } catch {}\n      if (this.inactivityTimer) {\n        clearTimeout(this.inactivityTimer);\n        this.inactivityTimer = null;\n      }\n      this.router.navigate(['/login']);\n    }\n    bumpActivity() {\n      if (!this.isLoggedIn()) return;\n      this.scheduleAutoLogout();\n    }\n    scheduleAutoLogout() {\n      if (this.inactivityTimer) clearTimeout(this.inactivityTimer);\n      this.inactivityTimer = setTimeout(() => this.logout(), this.autoLogoutMs);\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}